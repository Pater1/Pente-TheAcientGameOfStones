<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" />
    <META NAME="save" CONTENT="history" />
    <title>ObjectGraphComparer Class</title>
    <link rel="stylesheet" type="text/css" href="../styles/presentation.css" />
    <link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" />
    <script type="text/javascript" src="../scripts/EventUtilities.js"> </script>
    <script type="text/javascript" src="../scripts/SplitScreen.js"> </script>
    <script type="text/javascript" src="../scripts/Dropdown.js"> </script>
    <script type="text/javascript" src="../scripts/script_manifold.js"> </script>
    <script type="text/javascript" src="../scripts/script_feedBack.js"> </script>
    <script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script>
    <script type="text/javascript" src="../scripts/CommonUtilities.js"> </script>
    <meta name="container" content="Microsoft.Test.ObjectComparison" />
    <meta name="file" content="T_Microsoft_Test_ObjectComparison_ObjectGraphComparer" />
    <meta name="guid" content="T_Microsoft_Test_ObjectComparison_ObjectGraphComparer" />
    <xml>
      <MSHelp:Attr Name="AssetID" Value="T:Microsoft.Test.ObjectComparison.ObjectGraphComparer" />
      <MSHelp:TOCTitle Title="ObjectGraphComparer Class" />
      <MSHelp:RLTitle Title="ObjectGraphComparer Class (Microsoft.Test.ObjectComparison)" />
      <MSHelp:Keyword Index="A" Term="T:Microsoft.Test.ObjectComparison.ObjectGraphComparer" />
      <MSHelp:Keyword Index="A" Term="frlrfMicrosoftTestObjectComparisonObjectGraphComparerClassTopic" />
      <MSHelp:Keyword Index="K" Term="ObjectGraphComparer class" />
      <MSHelp:Keyword Index="K" Term="Microsoft.Test.ObjectComparison.ObjectGraphComparer class" />
      <MSHelp:Keyword Index="K" Term="ObjectGraphComparer class, about ObjectGraphComparer class" />
      <MSHelp:Keyword Index="F" Term="ObjectGraphComparer" />
      <MSHelp:Keyword Index="F" Term="Microsoft.Test.ObjectComparison.ObjectGraphComparer" />
      <MSHelp:Attr Name="HelpPriority" Value="2" />
      <MSHelp:Attr Name="APIType" Value="Managed" />
      <MSHelp:Attr Name="APILocation" Value="TestApiCore.dll" />
      <MSHelp:Attr Name="APIName" Value="Microsoft.Test.ObjectComparison.ObjectGraphComparer" />
      <MSHelp:Attr Name="DevLang" Value="CSharp" />
      <MSHelp:Attr Name="DevLang" Value="VB" />
      <MSHelp:Attr Name="DevLang" Value="C++" />
      <MSHelp:Attr Name="Locale" Value="en-us" />
      <MSHelp:Attr Name="TopicType" Value="kbSyntax" />
      <MSHelp:Attr Name="TopicType" Value="apiref" />
      <MSHelp:Attr Name="Abstract" Value="Represents a generic object graph comparer. This class compares object graphs produced by an ." />
      <MSHelp:Attr Name="AssemblyVersion" Value="0.0.0.0" />
      <MSHelp:Attr Name="NoName" Value="" />
    </xml>
    <link type="text/css" rel="stylesheet" href="../styles/highlight.css" />
    <script type="text/javascript" src="../scripts/highlight.js"></script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle" />
    <input type="hidden" id="hiddenScrollOffset" />
    <img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" title="Collapse image" />
    <img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" title="Expand Image" />
    <img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" />
    <img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" />
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" />
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" />
    <img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" title="Copy image" />
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" title="CopyHover image" />
    <div id="header">
      <table id="topTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0">
              <img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span>
            <span>    </span>
            <span id="devlangsDropdown" class="filter" tabindex="0">
              <img id="devlangsDropdownImage" src="../icons/dropdown.gif" /> <label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: All </nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple </nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C# </nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic </nobr></label><label id="devlangsMenuManagedCPlusPlusLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual C++ </nobr></label></span>
          </td>
        </tr>
      </table>
      <div id="devlangsMenu">
        <input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" />
        <label class="checkboxLabel" for="CSharpCheckbox">C#</label>
        <br />
        <input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,'persist'" value="on" onClick="SetLanguage(this)" />
        <label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label>
        <br />
        <input id="ManagedCPlusPlusCheckbox" type="checkbox" data="ManagedCPlusPlus,cpp,'persist'" value="on" onClick="SetLanguage(this)" />
        <label class="checkboxLabel" for="ManagedCPlusPlusCheckbox">Visual C++</label>
        <br />
      </div>
      <table id="bottomTable" cellpadding="0" cellspacing="0">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">.</span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">ObjectGraphComparer Class</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td align="left">
            <a href="AllMembers_T_Microsoft_Test_ObjectComparison_ObjectGraphComparer.htm">Members</a>  <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a>  <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a>  
  <span id="headfeedbackarea" class="feedbackhead">
      <a href="javascript:SubmitFeedback('testapi@microsoft.com','.','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">
        
        Send Feedback
      </a>
	</span>
</td>
        </tr>
      </table>
      <table id="gradientTable">
        <tr>
          <td class="nsrBottom" background="../icons/gradient.gif" />
        </tr>
      </table>
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" />
        <span style="color: DarkGray"> </span>
        <div class="summary">
             Represents a generic object graph comparer. This class compares object 
             graphs produced by an <a href="T_Microsoft_Test_ObjectComparison_ObjectGraphFactory.htm">ObjectGraphFactory</a>.
             </div>
        <p />
    <b>Namespace:</b> 
   <a href="N_Microsoft_Test_ObjectComparison.htm">Microsoft.Test.ObjectComparison</a><br />
    <b>Assembly:</b>
   <span sdata="assembly">TestApiCore</span> (in TestApiCore.dll) Version: 0.0.0.0<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="identifier">ObjectGraphComparer</span></pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic (Declaration)</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">NotInheritable</span> <span class="keyword">Class</span> <span class="identifier">ObjectGraphComparer</span></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">ObjectGraphComparer</span> <span class="keyword">sealed</span></pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="">
             Comparing two objects for equivalence is a relatively common task during test validation. 
             One example would be to test whether a type follows the rules required by a particular 
             serializer by saving and loading the object and comparing the two. A deep object 
             comparison is one where all the properties and its properties are compared repeatedly 
             until primitives are reached. The .NET Framework provides mechanisms to perform such comparisons but 
             requires the types in question to implement part of the comparison logic 
             (IComparable, .Equals). However, there are often types that do not follow 
             these mechanisms. This API provides a mechanism to deep compare two objects using 
             reflection. 
             </div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style="">
             The following example demonstrates how to compare two objects using a general-purpose object 
             graph factory (represented by <a href="T_Microsoft_Test_ObjectComparison_PublicPropertyObjectGraphFactory.htm">PublicPropertyObjectGraphFactory</a>).
             
             <span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>C#</div><div class="code"><pre>Person p1 = <span class="highlight-keyword">new</span> Person(<span class="highlight-literal">"John"</span>);
p1.Children.Add(<span class="highlight-keyword">new</span> Person(<span class="highlight-literal">"Peter"</span>));
p1.Children.Add(<span class="highlight-keyword">new</span> Person(<span class="highlight-literal">"Mary"</span>));

Person p2 = <span class="highlight-keyword">new</span> Person(<span class="highlight-literal">"John"</span>);
p2.Children.Add(<span class="highlight-keyword">new</span> Person(<span class="highlight-literal">"Peter"</span>));

ObjectGraphFactory factory = <span class="highlight-keyword">new</span> PublicPropertyObjectGraphFactory();
GraphNode left = factory.CreateObjectGraph(p1);
GraphNode right = factory.CreateObjectGraph(p2);
ObjectComparer comparer = <span class="highlight-keyword">new</span> ObjectGraphComparer();
Console.WriteLine(
    <span class="highlight-literal">"Objects p1 and p2 {0}"</span>, 
    comparer.Compare(left, right) ? <span class="highlight-literal">"match!"</span> : <span class="highlight-literal">"do NOT match!"</span>);</pre></div></span>
            
             where Person is declared as follows:
            
             <span id="cbc_2" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>C#</div><div class="code"><pre><span class="highlight-keyword">class</span> Person
{
    <span class="highlight-keyword">public</span> Person(<span class="highlight-keyword">string</span> name) 
    { 
        Name = name;
        Children = <span class="highlight-keyword">new</span> Collection&lt;Person&gt;();
    }
    <span class="highlight-keyword">public</span> <span class="highlight-keyword">string</span> Name { get; set; }
    <span class="highlight-keyword">public</span> Collection&lt;Person&gt; Children { get; <span class="highlight-keyword">private</span> set;  }
}</pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style="">
             In addition, the object comparison API allows the user to get back a list of comparison mismatches. 
             For an example, see <a href="T_Microsoft_Test_ObjectComparison_ObjectComparisonMismatch.htm">ObjectComparisonMismatch</a> objects. 
             </div><h1 class="heading"><span onclick="ExpandCollapse(familyToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(familyToggle, event)" tabindex="0"><img id="familyToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Inheritance Hierarchy</span></h1><div id="familySection" class="section" name="collapseableSection" style=""><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span></span>Object</a><br />  <span class="selflink">Microsoft.Test.ObjectComparison<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span></span>ObjectGraphComparer</span><br /></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="AllMembers_T_Microsoft_Test_ObjectComparison_ObjectGraphComparer.htm">ObjectGraphComparer Members</a></div><div class="seeAlsoStyle"><a href="N_Microsoft_Test_ObjectComparison.htm">Microsoft.Test.ObjectComparison Namespace</a></div></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" src="../icons/footer.gif" title="Footer image" />
        </div>
        <A NAME="feedback"></A>
        <span id="fb" class="feedbackcss" style="display: none;"> </span>
<p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:testapi%40microsoft.com?Subject=.">testapi@microsoft.com</a>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div>
    </div>
  </body>
</html>